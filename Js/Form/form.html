<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <title>Document</title>
  </head>
  <body>
    <main class="border h-dvh grid grid-cols-1 lg:grid-cols-2 p-2 gap-3">
      <section class="grid place-items-center">
        <form
          action=""
          class="flex flex-col items-start p-2 gap-5 w-[400px] h-[40vh]"
        >
          <input
            type="text"
            name="fName"
            class="w-full h-10 px-2 shadow-2xl"
            placeholder="Enter a first name"
          />
          <input
            type="text"
            name="lName"
            class="w-full h-10 px-2 shadow-2xl"
            placeholder="Enter a last name"
          />
          <input
            type="email"
            name="email"
            class="w-full h-10 px-2 shadow-2xl"
            placeholder="Enter an email"
          />
          <input
            type="tel"
            name="phone"
            class="w-full h-10 px-2 shadow-2xl"
            placeholder="Enter a phone number"
            pattern="[0-9]{10}"
            maxlength="10"
          />
          <div>
            <input type="radio" name="gender" value="Male" />
            <label for="">Male</label>
            <input type="radio" name="gender" value="Female" />
            <label for="">Female</label>
          </div>
          <button
            type="submit"
            class="w-full h-10 shadow-2xl hover:bg-black hover:text-white cursor-pointer rounded-2xl"
          >
            Submit
          </button>
        </form>
      </section>
      <section class="border">
        <ul class="flex flex-col gap-5 h-[50vh] overflow-y-auto p-2"></ul>
      </section>
    </main>
    <script>
      const Form = document.querySelector("form");
      const UL = document.querySelector("ul");

      let arr = JSON.parse(localStorage.getItem("User")) || [];
      let editId = null;

      Form.addEventListener("submit", (e) => {
        e.preventDefault();

        const newForm = new FormData(Form);

        const obj = {};

        for (let [key, value] of newForm.entries()) {
          // console.info(`${key}: ${value}`);
          obj[key] = value;
        }

        if (editId !== null) {
          arr = arr.map((list) => list.id === editId ? {...list, ...obj} : list)
          editId = null
        } else {
          obj.id = arr.length + 1;
          arr.push(obj);
        }
        renderData(arr);
        Form.reset();

        localStorage.setItem("User", JSON.stringify(arr));
      });

      // Display the task
      function renderData(arrOfObj) {
        UL.innerHTML = `
          ${
            arrOfObj.length > 0
              ? `
            ${arrOfObj
              .map(
                (list, idx) => `
                <li class="flex items-center gap-5 p-2 shadow-2xl">
                  <div>${idx + 1}</div>
                  <div class="flex-1">${list.fName} ${list.lName}</div>
                  <div>
                    <button
                      onclick="handleUpdate(${list.id})"
                      class="text-lime-500 outline w-15 hover:bg-lime-500 hover:text-white"
                    >
                      Edit
                    </button>
                  </div>
                  <div>
                    <button
                      class="text-rose-500 outline w-15 hover:bg-rose-500 hover:text-white"
                    >
                      Delete
                    </button>
                  </div>
                </li>
            `
              )
              .join("")}
          `
              : `<li class="text-xl font-bold text-center">No Data Added</li>`
          }
        `;
      }

      renderData(arr);

      // Update
      function handleUpdate(id) {
        // console.info(id);
        const listFound = arr.find((u) => u.id === id);

        const inputAll = Form.querySelectorAll(`input`);
        // console.info(inputAll)

        inputAll.forEach((input) => {
          // console.info(input)
          const keyName = input.name;

          input.value = listFound[keyName];
        });

        editId = id;

        // console.info(listFound);
      }
    </script>
  </body>
</html>
