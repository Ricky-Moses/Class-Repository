<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB"
      crossorigin="anonymous"
    />
  </head>
  <body style="height: 100vh" class="d-flex flex-column">
    <header>
      <nav class="navbar bg-body-tertiary">
        <div class="container-fluid">
          <a class="navbar-brand" id="user">Navbar</a>
          <form class="d-flex" role="search">
            <input
              class="form-control me-2"
              type="search"
              placeholder="Search"
              aria-label="Search"
            />
            <button class="btn btn-outline-success" type="submit">
              Search
            </button>
          </form>
          <div id="profile">
            <button class="btn btn-outline-info">Sign Up</button>
          </div>
        </div>
      </nav>
    </header>

    <!-- Home -->
    <main
      id="home"
      class="border flex-grow-1 d-none align-items-center justify-content-center"
    >
      <h1>Home</h1>
    </main>

    <!-- Register page -->
    <section
      id="register"
      class="flex-grow-1 d-flex flex-column align-items-center justify-content-center"
    >
      <h1>Register Section</h1>
      <form action="" class="w-25">
        <div class="form-floating mb-3">
          <input
            type="text"
            name="name"
            class="form-control"
            id="floatingInput"
            placeholder="user name"
          />
          <label for="floatingInput">User name</label>
        </div>
        <div class="form-floating mb-3">
          <input
            type="email"
            name="email"
            class="form-control"
            id="floatingInput"
            placeholder="name@example.com"
          />
          <label for="floatingInput">Email address</label>
        </div>
        <div class="form-floating mb-3">
          <input
            type="password"
            name="password"
            class="form-control"
            id="floatingPassword"
            placeholder="Password"
          />
          <label for="floatingPassword">Password</label>
        </div>
        <div class="submit-btn">
          <input
            type="submit"
            value="Register"
            class="btn btn-outline-primary"
          />
        </div>
      </form>
    </section>
    <!-- Login page -->
    <section
      id="login"
      class="flex-grow-1 d-none flex-column align-items-center justify-content-center"
    >
      <h1>Login Section</h1>
      <form action="" class="w-25">
        <div class="form-floating mb-3">
          <input
            type="email"
            name="email"
            class="form-control"
            id="floatingInput"
            placeholder="name@example.com"
          />
          <label for="floatingInput">Email address</label>
        </div>
        <div class="form-floating mb-3">
          <input
            type="password"
            name="password"
            class="form-control"
            id="floatingPassword"
            placeholder="Password"
          />
          <label for="floatingPassword">Password</label>
        </div>
        <div class="submit-btn">
          <input type="submit" value="Login" class="btn btn-outline-primary" />
        </div>
      </form>
    </section>

    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI"
      crossorigin="anonymous"
    ></script>

    <script>
      // Header
      const headerEl = document.querySelector("header");
      const homeSection = document.querySelector("#home");
      const registerSection = document.querySelector("#register");
      const registerFormEl = registerSection.querySelector("form");
      const loginSection = document.querySelector("#login");
      const loginFormEl = loginSection.querySelector("form");

      // Profile button
      const profileBtn = headerEl.querySelector("#profile button");

      // Open the register page
      profileBtn.addEventListener("click", () => {
        homeSection.classList.add("d-none");
        registerSection.classList.remove("d-none");
        registerSection.classList.add("d-flex");
      });

      // Store the user in localStorage as "User"
      const obj = {};

      //   Register form
      registerFormEl.addEventListener("submit", (e) => {
        e.preventDefault();
        // console.log(e);
        const registerForm = new FormData(registerFormEl);

        for (let [key, value] of registerForm.entries()) {
          //   console.log(`${key}: ${value}`);
          obj[key] = value;
        }
        localStorage.setItem("User", JSON.stringify(obj));
        alert("Successfully Registered");

        // console.log(obj);
        registerSection.classList.add("d-none");
        loginSection.classList.remove("d-none");
        loginSection.classList.add("d-flex");
      });

      // Login
      loginFormEl.addEventListener("submit", (e) => {
        e.preventDefault();

        const loginForm = new FormData(loginFormEl);
        const loggedUser = Object.fromEntries(loginForm);
        // console.log(loggedUser);

        const storedUser = JSON.parse(localStorage.getItem("User"));
        console.log(storedUser);

        if (storedUser) {
          if (
            storedUser.email === loggedUser.email &&
            storedUser.password === loggedUser.password
          ) {
            alert("Successfully logged!");
            headerEl.querySelector("#user").textContent = storedUser.name;
          } else {
            alert("Invalid User or Register new user");
          }
        }
      });
    </script>
  </body>
</html>
